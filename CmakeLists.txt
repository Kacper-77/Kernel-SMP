cmake_minimum_required(VERSION 3.16)
set(CMAKE_SYSTEM_NAME Generic)

# Clang
set(CMAKE_C_COMPILER "clang")
set(CMAKE_ASM_COMPILER "clang")

project(KernelSMP C ASM)

include_directories(${CMAKE_SOURCE_DIR}/common)

# Subdirectories
add_subdirectory(boot)
add_subdirectory(kernel)
add_subdirectory(user)

add_custom_target(initrd ALL
    COMMAND tar -cf ${CMAKE_BINARY_DIR}/initrd.tar -C ${CMAKE_SOURCE_DIR}/ramdisk .
    DEPENDS init.elf
    COMMENT "Packing TAR..."
)
